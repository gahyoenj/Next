# SSG

### SSR

- 넥스트 서버가 접속 요청을 받을 때마다 js 실행 시켜서 사전 렌더링 진행
- 다시 한번 요청이 들어오면 계속해서 사전 렌더링 진행해 페이지를 새롭게 생성
- 브라우저 접속 요청 들어올 때마다 사전 렌더링 과정에서 백엔드 서버에 요청 할 수 있음
  => 페이지 내부의 데이터를 항상 최신으로 유지할 수 있다
  => 하지만 데이터 요청이 늦어질 경우 모든게 늦어짐..

### SSG

- SSR 단점을 해결하는 사전 렌더링 방식
- 빌드 타임에 미리 페이지를 사전 렌더링
- 빌드 타임에 사전에 페이지를 딱 한번만 생성해둠
- 접속 요청을 하게 되면 빌드타임에 만들어놓은 HTML을 렌더링
  => 사전 렌더링에 많은 시간이 소요되는 페이지더라도 사용자의 요청에는 매우 빠른속도로 응답 가능
  => 빌드 타임 이후에는 페이지 새롭게 생성하지 않기 때문에 매번 똑같은 페이지만 응답..
  => 최신 데이터 반영은 어려움
  => 따라서 정적인 페이지에 적합

```javaScript
export const getStaticProps = async () => {
  return {
    props: {
    },
  };
};
```

- getStaticProps 함수를 사용하면 SSG 방식으로 작동

- 빌드결과 하단의 기호의 의미

  - 흰색 동그라미 => 이 페이지가 SSG로 작동한다는 의미 (HTML로 사전 렌더링된 페이지)
  - f => 다이나믹 페이지(주문형) /브라우저로 요청 받을 때마다 다이나믹하게 작동
    - api routes들은 자동으로 f => next가 자동으로 api routes를 ssr로 작동하게 하기 때문
  - 빈 동그라미 => SSG와 동일한 정적 페이지이지만 기본값으로 설정된 정적 페이지
    - next에선 아무것도 적용하지 않은 페이지에서는 정적 페이지로 빌드타임에 사전 렌더링하도록 설정
    - 기본값으로 SSG!

- getStaticProps에는 query라는 property가 존재하지 않음
  - 빌드타임에 실행되므로!
  - query라는건 브라우저에서 전달되는 것이므로
  - 결론적으로 query를 써야한다면 ssg는 사용불가!
    => 데이터페칭을 사전에는 못함

<br>
- [id].tsx는 다이나믹한 경로를 가짐
  - url parameter 값에 따라 여러개의 페이지를 렌더링 할 수 있음
  - 빌드타임에 ssg 방식으로 사전 렌더링 하려면 이 페이지에 어떠한 url parameter들이 존재할 수 있는지 설정하는 과정이 필요!
  - 그렇지 않으면 사전렌더링 진행 할 수 없음
  - 백엔드 서버에서부터 등록된 id를 받아온다던지 id 몇개를 지정해두던지 해서 미리 설정해두어야함

#### => getStaticPaths 함수 이용!

    - fallback 옵션 => 설정해둔 url 파라미터가 아닌 경로를 요청하게 됐을 때 대비책
      - fallback: false => not found 페이지 반환
      - fallback: blocking => 즉시 생성 (Like SSR) 해서 반환
        - 빌드타임에 모든 데이터를 불러오지 못하는 상황에 사용하면 됨(또는 데이터가 계속 추가되는 경우)
      - fallback: true => 즉시 생성 + 페이지만 미리 반환
        - 일단 props 없는 페이지 반환 후 props만 따로 계산해서 따로 반환
        - fallback 상태: 페이지 컴포넌트가 아직 서버로부터 데이터를 전달받지 못한 상태
